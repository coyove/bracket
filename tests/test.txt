function add(a,b) return a + b end

set fib2 = function()
    set a, b = 0, 1
    while true do
        set c = add(a, b)
        a = b
        b = c
        yield c
    end
end
 
 set fib3 = dup(fib2)
 
set i = 0 while i < 33 then i = i + 1 do fib2() end
assert (fib2())==9227465 
assert (fib3()+fib3()+fib3()+fib3()) == 11

function deepadd(a)
    if a <= 0 then return 0 end
    return add(a)(deepadd(a - 1))
end

assert deepadd(100000) == 5000050000 
 
set a = 2
assert 1 + 2 *3/5 == 2.2
assert 1 /2+ 2.2 * 5 * (a + 1) == 33.5
assert 1 /2+ 2.2 * (a + 1) * 5 == 33.5

set l, l2 = list 1,2,3 end, list "1","2","3" end
assert (l + l2) == list 1,2,3, list "1", "2", "3" end end
assert (l & l2) == list 1,2,3, "1", "2", "3" end 
assert l == list 1,2,3 end and l2(1,-1) == list "2" end

set mul = (function(a) set b = 1 return function() b = b * a return b end end)(2)

assert mul() == 2 and mul() == 4 and mul() == 8

#require "fib.txt"

#io.println(fib)