`script` is a simple script engine written in golang with Lua-like syntax.

(If you are looking for a Lua 5.2 compatible engine, refer to tag `v0.2`)

## Can & Can't

- You can't create closures (e.g. a function returns/inside a function) inside the script, but you do can return functions to Go callers.
- You can't write variadic functions, as they all accept arbitrary arguments by default, you can use `debug.dumpstk()` to get a full list of arguments passed in.
- You can use optional arguments to write clean code: `function f(a, b) end; f(b=1)`, use `debug.kwargs()` to get a full map (name->value) of arguments passed in.
- Writing `function f() return 1, 2 end; local a, b = f()` will be translated into `function f() return {1, 2} end; local tmp = f(); local a, b = tmp[0], tmp[1]`.
- You can define more than 255 variables in a function (up to ~4000, depending on the number of temporal variables generated by interpreter).
- `number` is `int64 + float64` internally, interpreter may promote it to `float64` when needed and downgrade it to `int64` when possible.
- Everything starts at ZERO.

## Run

```golang
program, err := script.LoadString("return 1")
v, err := program.Run() // v == 1
```

### Global Values

```golang
script.AddGlobalValue("G", func() int { return 1 })

program, _ := script.LoadString("return G() + 1")
v, err := program.Run() // v == 2

program, _ = script.LoadString("return G() + 2")
v, err = program.Run() // v == 3

program, _ = script.LoadString("return G + 2", &CompileOptions{
	GlobalKeyValues: {
		"G": 10, // override the global 'G'
	},
})
v, err = program.Run() // v == 12
```

### Encapsulation

```lua
Car = {_brand=''}
function Car.get_brand(this)
	if this._brand then return str.from('a %s car #%d').format(this._brand, this.index) end
	return 'a car'
end
Benz = new(Car, {_brand='benz'})
Honda = new(Car, {_brand='honda'})

b0 = new(Car)
b1 = new(Benz, {index=1})
b2 = new(Benz, {index=2})
b3 = new(Honda, {index=3})
println(b0.get_brand(), b1.get_brand(), b2.get_brand(), b3.get_brand())
```

## Benchmarks

Refer to [here](https://github.com/coyove/potatolang/blob/master/tests/bench/perf.md).

